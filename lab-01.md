# Лабораторна робота 1. Проєктування REST API

**Дисципліна:** Технології проектування та розробки мережевих ресурсів  
**Тема:** Проєктування REST API для системи управління задачами  
**Тривалість:** 2 години

---

## Мета роботи

Навчитися проєктувати REST API, застосовуючи принципи resource-oriented design, правильно використовуючи HTTP методи та статус-коди. Студенти мають продемонструвати базове розуміння принципів REST.

---

## Теоретичні відомості

### Принципи REST API

REST API проєктується навколо концепції ресурсів:

- Кожен ресурс має унікальний URI.
- Операції виконуються через HTTP методи.
- Використовуються стандартні статус-коди.

### HTTP методи

- **GET** - отримання ресурсу (безпечний, ідемпотентний).
- **POST** - створення ресурсу (не ідемпотентний).
- **PUT** - повне оновлення ресурсу (ідемпотентний).
- **PATCH** - часткове оновлення ресурсу.
- **DELETE** - видалення ресурсу (ідемпотентний).

### HTTP статус-коди

**2xx Успішні відповіді:**

- 200 OK - успішний GET, PUT, PATCH.
- 201 Created - успішний POST.
- 204 No Content - успішний DELETE.

**4xx Помилки клієнта:**

- 400 Bad Request - некоректні дані.
- 401 Unauthorized - потрібна автентифікація.
- 404 Not Found - ресурс не існує.
- 409 Conflict - конфлікт стану.

**5xx Помилки сервера:**

- 500 Internal Server Error - помилка сервера.

### Об'єкти передачі даних (DTO)

DTO відокремлюють внутрішню модель від API:

- **CreateDTO** - дані для створення (без id).
- **UpdateDTO** - дані для оновлення (необов'язкові поля).
- **ResponseDTO** - дані у відповіді (включає readonly поля).

---

## Завдання

Спроєктуйте REST API для простої системи управління задачами.

### Функціональні вимоги

**Задачі (Tasks):**

- Створення задачі.
- Перегляд списку задач.
- Перегляд конкретної задачі.
- Оновлення задачі.
- Видалення задачі.
- Фільтрація за статусом.

**Користувачі (Users):**

- Перегляд списку користувачів.
- Перегляд конкретного користувача.

### Атрибути

**Task:**

- Назва (обов'язково, 3-200 символів).
- Опис (необов'язково, максимум 1000 символів).
- Статус: todo, in_progress, done.
- Пріоритет: low, medium, high.
- Дата створення (автоматично).

**User:**

- Ім'я.
- Email.

---

## Хід роботи

### Частина 1. Аналіз предметної області (15 хв)

Заповніть таблицю:

| Ресурс | Основні атрибути |
|--------|------------------|
| Task | id, title, description, status, priority, createdAt |
| User | id, name, email |

---

### Частина 2. Проєктування кінцевих точок API (30 хв)

Створіть таблицю кінцевих точок (мінімум 7):

| HTTP метод | Шлях URI | Опис | Статус-коди |
|------------|----------|------|-------------|
| GET | /api/tasks | Список задач | 200, 401 |
| GET | /api/tasks/{id} | Конкретна задача | 200, 404, 401 |
| POST | /api/tasks | Створити задачу | 201, 400, 401 |
| PUT | /api/tasks/{id} | Оновити задачу | 200, 400, 404, 401 |
| DELETE | /api/tasks/{id} | Видалити задачу | 204, 404, 401 |
| GET | /api/users | Список користувачів | 200, 401 |
| GET | /api/users/{id} | Конкретний користувач | 200, 404, 401 |

**Фільтрація:**
```
GET /api/tasks?status=done
GET /api/tasks?priority=high&status=in_progress
```

**Питання для роздумів:**

1. Чому GET /api/tasks/{id} повертає 404, коли задача не існує?
2. Чому DELETE повертає 204, а не 200?
3. Яка різниця між PUT та PATCH?

---

### Частина 3. Структури даних (40 хв)

Опишіть JSON структури:

**Відповідь Task:**
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "title": "Завершити лабораторну роботу",
  "description": "Спроєктувати REST API",
  "status": "in_progress",
  "priority": "high",
  "createdAt": "2025-10-21T10:30:00Z"
}
```

**CreateTaskDTO:**
```json
{
  "title": "string (обов'язково, 3-200 символів)",
  "description": "string (необов'язково, максимум 1000 символів)",
  "priority": "low | medium | high (за замовчуванням: medium)"
}
```

**UpdateTaskDTO:**
```json
{
  "title": "string (необов'язково, 3-200 символів)",
  "description": "string (необов'язково, максимум 1000 символів)",
  "status": "todo | in_progress | done (необов'язково)",
  "priority": "low | medium | high (необов'язково)"
}
```

**Відповідь User:**
```json
{
  "id": "7c9e6679-7425-40de-944b-e07fc1f90ae7",
  "name": "Іван Петренко",
  "email": "ivan@example.com"
}
```

**Список задач:**
```json
{
  "data": [
    { /* об'єкт Task */ },
    { /* об'єкт Task */ }
  ],
  "total": 42
}
```

---

### Частина 4. Обробка помилок (25 хв)

**Стандартна структура помилки:**
```json
{
  "error": {
    "code": "ERROR_CODE",
    "message": "Зрозуміле повідомлення",
    "timestamp": "2025-10-21T10:30:00Z"
  }
}
```

**Основні коди помилок:**

| HTTP статус | Код помилки | Приклад |
|-------------|-------------|---------|
| 400 | VALIDATION_ERROR | "Назва обов'язкова" |
| 401 | AUTHENTICATION_REQUIRED | "Відсутній токен" |
| 404 | RESOURCE_NOT_FOUND | "Задачу не знайдено" |
| 409 | CONFLICT | "Задача вже існує" |
| 500 | INTERNAL_ERROR | "Помилка сервера" |

**Приклад помилки валідації:**
```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Не вдалося пройти валідацію",
    "details": [
      {
        "field": "title",
        "message": "Назва повинна містити щонайменше 3 символи"
      }
    ],
    "timestamp": "2025-10-21T10:30:00Z"
  }
}
```

**Приклад помилки відсутності ресурсу:**
```json
{
  "error": {
    "code": "RESOURCE_NOT_FOUND",
    "message": "Задачу з ідентифікатором '123' не знайдено",
    "timestamp": "2025-10-21T10:30:00Z"
  }
}
```

---

### Частина 5. Додатково (необов'язково, +1 бал)

**Опція А:** Опишіть 2-3 кінцеві точки у форматі OpenAPI 3.0

**Опція Б:** Додайте посторінкову навігацію та розширені фільтри

---

## Форма здачі

Створіть файл `lab-01-[прізвище].md` з наступною структурою:

```markdown
# Лабораторна робота 1: Проєктування REST API

**ПІБ:** [Ваше ПІБ]
**Група:** [Група]
**Дата:** [Дата]

## 1. Аналіз предметної області

| Ресурс | Атрибути |
|--------|----------|
| Task | ... |
| User | ... |

## 2. Кінцеві точки API

| HTTP метод | Шлях URI | Опис | Статус-коди |
|------------|----------|------|-------------|
| ... | ... | ... | ... |

**Пояснення:** [Чому обрали такі кінцеві точки]

## 3. Структури даних

### Відповідь Task
\```json
{...}
\```

### CreateTaskDTO
\```json
{...}
\```

### UpdateTaskDTO
\```json
{...}
\```

### Відповідь User
\```json
{...}
\```

### Відповідь помилки
\```json
{...}
\```

## 4. Відповіді на питання

1. [Відповідь]
2. [Відповідь]
3. [Відповідь]

## 5. Висновки

[Ваші висновки]
```

**Здача:** Moodle курс дисципліни

---

## Критерії оцінювання

Максимальна оцінка: **4 бали** (+ **1 бонусний**)

| Критерій | Бали | Що оцінюється |
|----------|------|---------------|
| Аналіз | 0.5 | Ресурси та атрибути |
| Кінцеві точки | 1.5 | HTTP методи, URI, статус-коди |
| Структури | 1.0 | JSON для Task, User, DTO, помилки |
| Обробка помилок | 0.5 | Структура та коди |
| Відповіді | 0.5 | Розуміння REST |
| **Бонус** | +1.0 | OpenAPI або розширення |

### Як отримати максимум:

✅ **0.5 за аналіз:**

- Task та User описані з атрибутами.

✅ **1.5 за кінцеві точки:**

- Мінімум 7 правильних кінцевих точок.
- Правильні HTTP методи.
- REST URI (іменники, множина).
- Правильні статус-коди.

✅ **1.0 за структури:**

- Відповідь Task.
- CreateTaskDTO та UpdateTaskDTO (різні!).
- Відповідь User.
- Відповідь помилки.

✅ **0.5 за помилки:**

- Стандартна структура.
- Мінімум 5 кодів помилок.
- 2 приклади.

✅ **0.5 за питання:**

- Обґрунтовані відповіді.

---

## Контрольні питання

1. У чому різниця між PUT та PATCH?
2. Чому важливо розділяти CreateDTO і UpdateDTO?
3. Який статус-код для успішного DELETE: 200 чи 204?
4. Як правильно називати URI: іменники чи дієслова?
5. Що означає "ідемпотентний" метод?
6. Коли використовувати 404 замість 400?

---

## Поширені помилки

❌ **Не робіть так:**

1. Дієслова в URI:
   ```
   ❌ POST /api/createTask
   ✅ POST /api/tasks
   ```

2. Неправильні статус-коди:
   ```
   ❌ 200 OK при створенні
   ✅ 201 Created
   ```

3. Однина для колекцій:
   ```
   ❌ /api/task
   ✅ /api/tasks
   ```

4. Те саме DTO для всього:
   ```
   ❌ Один TaskDTO
   ✅ CreateTaskDTO, UpdateTaskDTO, TaskResponse
   ```

✅ **Робіть так:**

- Іменники у множині: `/api/tasks`.
- Правильні HTTP методи для операцій.
- Різні DTO для створення/оновлення/відповіді.
- Стандартизовані помилки з кодами.
- ISO 8601 для дат: `2025-10-21T10:30:00Z`.

---

## Приклад виконання (фрагмент)

### 1. Аналіз предметної області

| Ресурс | Атрибути |
|--------|----------|
| Task | id (UUID), title (string), description (string), status (enum), priority (enum), createdAt (datetime) |
| User | id (UUID), name (string), email (string) |

### 2. Кінцеві точки API

| HTTP метод | Шлях URI | Опис | Статус-коди |
|------------|----------|------|-------------|
| GET | /api/tasks | Отримати список всіх задач | 200, 401 |
| GET | /api/tasks?status=done | Фільтр за статусом | 200, 401 |
| GET | /api/tasks/{id} | Отримати задачу за ID | 200, 404, 401 |
| POST | /api/tasks | Створити нову задачу | 201, 400, 401 |
| PUT | /api/tasks/{id} | Повністю оновити задачу | 200, 400, 404, 401 |
| PATCH | /api/tasks/{id} | Частково оновити задачу | 200, 400, 404, 401 |
| DELETE | /api/tasks/{id} | Видалити задачу | 204, 404, 401 |
| GET | /api/users | Отримати список користувачів | 200, 401 |
| GET | /api/users/{id} | Отримати користувача за ID | 200, 404, 401 |

**Пояснення:** Використовуємо конвенції REST - іменники у множині, стандартні HTTP методи. GET для читання, POST для створення, PUT для повного оновлення, DELETE для видалення. Фільтрація через параметри запиту.

---

## Додаткові ресурси

1. **RFC 7231** - HTTP/1.1 Semantics
2. **REST API Tutorial** - https://restfulapi.net/
3. **OpenAPI Specification** - https://swagger.io/specification/
4. **Richardson Maturity Model** - https://martinfowler.com/articles/richardsonMaturityModel.html

---

**Успіхів у виконанні лабораторної роботи!**

Час на проєктування - це інвестиція у майбутнє проєкту.
